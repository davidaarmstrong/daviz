<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Dave Armstrong" />

<meta name="date" content="2020-06-19" />

<title>Using the sigd3 and sigd3h Functions</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Using the sigd3 and sigd3h Functions</h1>
<h4 class="author">Dave Armstrong</h4>
<h4 class="date">2020-06-19</h4>



<p>The <code>sigd3</code> and <code>sigd3h</code> functions in the <code>{daviz}</code> package implement a novel type of D3 graphic that highlights points that are significantly/reliably different than the point being hovered over. A few different use cases are presented below.</p>
<div id="coefficient-plot" class="section level1">
<h1>Coefficient plot</h1>
<p>We could imagine making coefficient plots in a couple of different ways.</p>
<div id="model-object-input" class="section level2">
<h2>Model object input</h2>
<p>One use for this would be a coefficient plot from any object that has <code>coef()</code> and <code>vcov()</code> extractor functions and works with the <code>{factorplot}</code> package. Here we use the <code>Angell</code> data from the <code>{carData}</code> package to estimate a model of <code>moral</code> on <code>region</code>. We then use the <code>sigd3()</code> function to produce the plot.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(daviz)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw">data</span>(<span class="st">&quot;Angell&quot;</span>, <span class="dt">package=</span><span class="st">&quot;carData&quot;</span>)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3">mod &lt;-<span class="st"> </span><span class="kw">lm</span>(moral <span class="op">~</span><span class="st">  </span>region, <span class="dt">data=</span>Angell)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="kw">sigd3</span>(mod, <span class="st">&quot;region&quot;</span>, <span class="dt">fname=</span><span class="st">&quot;angell1.html&quot;</span>, <span class="dt">width=</span><span class="dv">750</span>, <span class="dt">ylab =</span> <span class="st">&quot;Effect of Region&quot;</span>)</a></code></pre></div>
<iframe src="angell1.html" height="525" width="787.5" style="border: none"></iframe>
<p>We have control over lots of the aspects of the plot, including the colors. Below, we have defined different colors for the plot using the <code>Ornestein</code> data from the <code>{carData}</code> pacakge.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">data</span>(<span class="st">&quot;Ornstein&quot;</span>, <span class="dt">package=</span><span class="st">&quot;carData&quot;</span>)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">omod &lt;-<span class="st"> </span><span class="kw">lm</span>(interlocks <span class="op">~</span><span class="st">  </span>nation <span class="op">+</span><span class="st"> </span>sector , <span class="dt">data=</span>Ornstein)</a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="kw">sigd3</span>(omod, <span class="st">&quot;sector&quot;</span>, <span class="dt">fname=</span><span class="st">&quot;orn.html&quot;</span>, <span class="dt">width=</span><span class="dv">900</span>, </a>
<a class="sourceLine" id="cb2-4" data-line-number="4">      <span class="dt">ylab =</span> <span class="st">&quot;Effect of Sector&quot;</span>, <span class="dt">axfont=</span><span class="dv">16</span>, <span class="dt">labfont=</span><span class="dv">20</span>, </a>
<a class="sourceLine" id="cb2-5" data-line-number="5">      <span class="dt">colors=</span><span class="kw">c</span>(<span class="st">&quot;purple&quot;</span>, <span class="st">&quot;lightgray&quot;</span>, <span class="st">&quot;black&quot;</span>))</a></code></pre></div>
<iframe src="orn.html" height="525" width="945" style="border: none"></iframe>
</div>
<div id="bayesian-mcmc-input" class="section level2">
<h2>Bayesian MCMC input</h2>
<p>If we either had an <code>mcmc</code> object or we had sampled from the posterior distribution treating the parameters of a frequentist model as posterior means and variances given flat priors (as below), we could make similar plot.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">X &lt;-<span class="st"> </span><span class="kw">model.matrix</span>(mod, </a>
<a class="sourceLine" id="cb3-2" data-line-number="2">                  <span class="dt">data=</span><span class="kw">data.frame</span>(<span class="dt">moral=</span><span class="dv">0</span>, </a>
<a class="sourceLine" id="cb3-3" data-line-number="3">                                  <span class="dt">region =</span> <span class="kw">factor</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="dt">labels=</span><span class="kw">levels</span>(Angell<span class="op">$</span>region))))</a>
<a class="sourceLine" id="cb3-4" data-line-number="4"></a>
<a class="sourceLine" id="cb3-5" data-line-number="5">b &lt;-<span class="st"> </span>MASS<span class="op">::</span><span class="kw">mvrnorm</span>(<span class="dv">1000</span>, <span class="kw">coef</span>(mod), <span class="kw">vcov</span>(mod))</a>
<a class="sourceLine" id="cb3-6" data-line-number="6">yhat &lt;-<span class="st"> </span><span class="kw">t</span>(X <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(b))</a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="kw">colnames</span>(yhat) &lt;-<span class="st"> </span><span class="kw">levels</span>(Angell<span class="op">$</span>region)</a>
<a class="sourceLine" id="cb3-8" data-line-number="8"><span class="kw">class</span>(yhat) &lt;-<span class="st"> &quot;mcmc&quot;</span></a>
<a class="sourceLine" id="cb3-9" data-line-number="9"><span class="kw">sigd3</span>(yhat, <span class="st">&quot;region&quot;</span>, <span class="dt">fname=</span><span class="st">&quot;angell2.html&quot;</span>, <span class="dt">width=</span><span class="dv">750</span>, <span class="dt">ylab =</span> <span class="st">&quot;Effect of Region&quot;</span>)</a></code></pre></div>
<iframe src="angell2.html" height="525" width="787.5" style="border: none"></iframe>
</div>
</div>
<div id="horizontal-orientation" class="section level1">
<h1>Horizontal orientation</h1>
<p>Some model objects will not be amenable to vertical line output. Either the names might be too long or there may be too many parameters to plot the lines vertically in an aesthetically pleasing fashion. Thus, the <code>sigd3h()</code> function makes a similar plot, but with horizontal orientation of the lines. Here’s the same example using the <code>Ornstein</code> data as above, but using the horizontal orientation.</p>
<div id="model-object-as-input" class="section level2">
<h2>Model object as input</h2>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw">sigd3h</span>(omod, <span class="st">&quot;sector&quot;</span>, <span class="dt">fname=</span><span class="st">&quot;orn2.html&quot;</span>, <span class="dt">height=</span><span class="dv">500</span>, <span class="dt">width=</span><span class="dv">500</span>, </a>
<a class="sourceLine" id="cb4-2" data-line-number="2">      <span class="dt">ylab =</span> <span class="st">&quot;Effect of Sector&quot;</span>, <span class="dt">axfont=</span><span class="dv">16</span>, <span class="dt">labfont=</span><span class="dv">20</span>, </a>
<a class="sourceLine" id="cb4-3" data-line-number="3">      <span class="dt">colors=</span><span class="kw">c</span>(<span class="st">&quot;purple&quot;</span>, <span class="st">&quot;lightgray&quot;</span>, <span class="st">&quot;black&quot;</span>), </a>
<a class="sourceLine" id="cb4-4" data-line-number="4">      <span class="dt">ptSize=</span><span class="kw">c</span>(<span class="fl">3.5</span>,<span class="dv">2</span>), <span class="dt">lineSize=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">1</span>))</a></code></pre></div>
<iframe src="orn2.html" height="525" width="525" style="border: none"></iframe>
</div>
<div id="mcmc-output-as-input" class="section level2">
<h2>MCMC output as input</h2>
<p>Below, we estimate a model with data from Alvarez, Garrett and Lange’s (1991) “Government Partisanship, Labor Organization and Macroeconomic Performance.” article in the <em>American Political Science Review</em>. We first estimate the model</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">jags.mod &lt;-<span class="st"> &quot;</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="st">model {</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="st">    ## macro (2nd level) model</span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="st">    for (i in 1:16) {             ## loop over countries</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="st">        for (k in 1:6) {            ## loop over parameters</span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="st">            eb[i,k] &lt;- g[k,1] + labor.org[i]*g[k,2];</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="st">            b[i,k] ~ dnorm( eb[i,k], p[k] );  </span></a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="st">            ## n.b., each 'random coefficient' b[i,k] sampled independently</span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="st">        }</span></a>
<a class="sourceLine" id="cb5-10" data-line-number="10"><span class="st">    }</span></a>
<a class="sourceLine" id="cb5-11" data-line-number="11"><span class="st">    </span></a>
<a class="sourceLine" id="cb5-12" data-line-number="12"><span class="st">  ## micro model</span></a>
<a class="sourceLine" id="cb5-13" data-line-number="13"><span class="st">    for (i in 1:224) {       ## loop over time within countries</span></a>
<a class="sourceLine" id="cb5-14" data-line-number="14"><span class="st">        ey[i] &lt;-  b[country[i],1]         ## double-subscript selects which </span></a>
<a class="sourceLine" id="cb5-15" data-line-number="15"><span class="st">          + (imports[i]-mean(imports[]))*b[country[i],5]  ## unit-specific </span></a>
<a class="sourceLine" id="cb5-16" data-line-number="16"><span class="st">        + (exports[i]-mean(exports[]))*b[country[i],4]  </span></a>
<a class="sourceLine" id="cb5-17" data-line-number="17"><span class="st">        + (demand[i]-mean(demand[]))*b[country[i],3]</span></a>
<a class="sourceLine" id="cb5-18" data-line-number="18"><span class="st">        + growth.lag[i]*b[country[i],2]</span></a>
<a class="sourceLine" id="cb5-19" data-line-number="19"><span class="st">        + (left[i]-mean(left[]))*b[country[i],6];</span></a>
<a class="sourceLine" id="cb5-20" data-line-number="20"><span class="st">        y[i] ~ dnorm( ey[i], tau[country[i]] );  ## likelihood</span></a>
<a class="sourceLine" id="cb5-21" data-line-number="21"><span class="st">    }</span></a>
<a class="sourceLine" id="cb5-22" data-line-number="22"><span class="st">    </span></a>
<a class="sourceLine" id="cb5-23" data-line-number="23"><span class="st">    for (k in 1:6){                 ## loop, convert precisions to </span></a>
<a class="sourceLine" id="cb5-24" data-line-number="24"><span class="st">       sigma.b[k] &lt;- sqrt(1/p[k]);  ## covariate-specific std err</span></a>
<a class="sourceLine" id="cb5-25" data-line-number="25"><span class="st">    }</span></a>
<a class="sourceLine" id="cb5-26" data-line-number="26"><span class="st">    </span></a>
<a class="sourceLine" id="cb5-27" data-line-number="27"><span class="st">  ## priors</span></a>
<a class="sourceLine" id="cb5-28" data-line-number="28"><span class="st">    for (i in 1:16) {                              </span></a>
<a class="sourceLine" id="cb5-29" data-line-number="29"><span class="st">        tau[i] ~ dgamma(1.0E-3,1.0E-3);    ## country-specific precisions</span></a>
<a class="sourceLine" id="cb5-30" data-line-number="30"><span class="st">        sigma[i] &lt;- sqrt(1/tau[i]);        ## country-specific resid std err</span></a>
<a class="sourceLine" id="cb5-31" data-line-number="31"><span class="st">    }</span></a>
<a class="sourceLine" id="cb5-32" data-line-number="32"><span class="st">    for (k in 1:6) {</span></a>
<a class="sourceLine" id="cb5-33" data-line-number="33"><span class="st">        p[k] ~  dgamma(1.0E-3,1.0E-3);     ## covariate-specific precisions </span></a>
<a class="sourceLine" id="cb5-34" data-line-number="34"><span class="st">        g[k,1:2] ~ dmnorm(g0[1:2],G0[1:2,1:2]); ## MVN prior, 2nd level parms</span></a>
<a class="sourceLine" id="cb5-35" data-line-number="35"><span class="st">    }   </span></a>
<a class="sourceLine" id="cb5-36" data-line-number="36"><span class="st">        </span></a>
<a class="sourceLine" id="cb5-37" data-line-number="37"><span class="st">    </span></a>
<a class="sourceLine" id="cb5-38" data-line-number="38"><span class="st">    g0[1] &lt;- 0.0; g0[2] &lt;- 0.0;     ## prior means, 2nd level </span></a>
<a class="sourceLine" id="cb5-39" data-line-number="39"><span class="st">    G0[1,1] &lt;- .001; G0[1,2] &lt;- 0;  ## prior precisions, 2nd level</span></a>
<a class="sourceLine" id="cb5-40" data-line-number="40"><span class="st">    G0[2,1] &lt;- 0; G0[2,2] &lt;- .001;</span></a>
<a class="sourceLine" id="cb5-41" data-line-number="41"><span class="st">    </span></a>
<a class="sourceLine" id="cb5-42" data-line-number="42"><span class="st">}</span></a>
<a class="sourceLine" id="cb5-43" data-line-number="43"><span class="st">&quot;</span></a>
<a class="sourceLine" id="cb5-44" data-line-number="44"></a>
<a class="sourceLine" id="cb5-45" data-line-number="45"><span class="kw">data</span>(corp)</a>
<a class="sourceLine" id="cb5-46" data-line-number="46"></a>
<a class="sourceLine" id="cb5-47" data-line-number="47"><span class="kw">library</span>(runjags)</a>
<a class="sourceLine" id="cb5-48" data-line-number="48">jags &lt;-<span class="st"> </span><span class="kw">run.jags</span>(<span class="dt">model =</span> jags.mod, <span class="dt">data=</span>corp, <span class="dt">monitor=</span><span class="kw">c</span>(<span class="st">&quot;b&quot;</span>, <span class="st">&quot;g&quot;</span>, <span class="st">&quot;ey&quot;</span>), <span class="dt">adapt=</span><span class="dv">2500</span>, <span class="dt">burnin=</span><span class="dv">10000</span>, <span class="dt">sample=</span><span class="dv">5000</span>)</a>
<a class="sourceLine" id="cb5-49" data-line-number="49"></a>
<a class="sourceLine" id="cb5-50" data-line-number="50">chains &lt;-<span class="st"> </span><span class="kw">combine.mcmc</span>(jags<span class="op">$</span>mcmc)</a>
<a class="sourceLine" id="cb5-51" data-line-number="51"><span class="kw">class</span>(chains) &lt;-<span class="st"> &quot;mcmc&quot;</span></a></code></pre></div>
<p>After running the model, we can then plot the random coefficients for demand.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">countries &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;AUL&quot;</span>, <span class="st">&quot;AUS&quot;</span>, <span class="st">&quot;BEL&quot;</span>, <span class="st">&quot;CAN&quot;</span>, <span class="st">&quot;DEN&quot;</span>, <span class="st">&quot;FIN&quot;</span>, <span class="st">&quot;FRA&quot;</span>, <span class="st">&quot;GER&quot;</span>, <span class="st">&quot;IRE&quot;</span>, <span class="st">&quot;ITA&quot;</span>, <span class="st">&quot;JAP&quot;</span>, <span class="st">&quot;NET&quot;</span>, <span class="st">&quot;NOR&quot;</span>, <span class="st">&quot;SWE&quot;</span>, <span class="st">&quot;UK&quot;</span>,  <span class="st">&quot;USA&quot;</span>)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2">ints &lt;-<span class="st"> </span>chains[,<span class="kw">grep</span>(<span class="st">&quot;^b</span><span class="ch">\\</span><span class="st">[.*3</span><span class="ch">\\</span><span class="st">]$&quot;</span>, <span class="kw">colnames</span>(chains))]</a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="kw">colnames</span>(ints) &lt;-<span class="st"> </span>countries</a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="kw">sigd3h</span>(ints, <span class="ot">NULL</span>, <span class="st">&quot;corp1.html&quot;</span>, <span class="dt">height=</span><span class="dv">600</span>, <span class="dt">width=</span><span class="dv">500</span>, <span class="dt">ylab=</span><span class="st">&quot;Random Coefficients for Demand&quot;</span>)</a></code></pre></div>
<iframe src="corp1.html" height="630" width="525" style="border: none"></iframe>
<p>To see the real benefits of the horizontal orientation, we could plot all of the predicted values (224 of them).</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">countries &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;AUL&quot;</span>, <span class="st">&quot;AUS&quot;</span>, <span class="st">&quot;BEL&quot;</span>, <span class="st">&quot;CAN&quot;</span>, <span class="st">&quot;DEN&quot;</span>, <span class="st">&quot;FIN&quot;</span>, <span class="st">&quot;FRA&quot;</span>, <span class="st">&quot;GER&quot;</span>, <span class="st">&quot;IRE&quot;</span>, <span class="st">&quot;ITA&quot;</span>, <span class="st">&quot;JAP&quot;</span>, <span class="st">&quot;NET&quot;</span>, <span class="st">&quot;NOR&quot;</span>, <span class="st">&quot;SWE&quot;</span>, <span class="st">&quot;UK&quot;</span>,  <span class="st">&quot;USA&quot;</span>)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">cn &lt;-<span class="st"> </span><span class="kw">paste</span>(countries[corp<span class="op">$</span>country], <span class="kw">rep</span>(<span class="dv">1971</span><span class="op">:</span><span class="dv">1984</span>, <span class="dv">16</span>), <span class="dt">sep=</span><span class="st">&quot;-&quot;</span>)</a>
<a class="sourceLine" id="cb7-3" data-line-number="3"></a>
<a class="sourceLine" id="cb7-4" data-line-number="4">preds &lt;-<span class="st"> </span>chains[,<span class="kw">grep</span>(<span class="st">&quot;^ey&quot;</span>, <span class="kw">colnames</span>(chains))]</a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="kw">colnames</span>(preds) &lt;-<span class="st"> </span>cn</a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="kw">class</span>(preds) &lt;-<span class="st"> &quot;mcmc&quot;</span></a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="kw">sigd3h</span>(preds, <span class="ot">NULL</span>, <span class="st">&quot;corp2.html&quot;</span>, <span class="dt">height=</span><span class="dv">2000</span>, <span class="dt">width=</span><span class="dv">500</span>, <span class="dt">ylab=</span><span class="st">&quot;Predicted Growth&quot;</span>, </a>
<a class="sourceLine" id="cb7-8" data-line-number="8">       <span class="dt">ptSize=</span><span class="kw">c</span>(<span class="fl">4.5</span>, <span class="fl">2.5</span>), <span class="dt">lineSize=</span><span class="kw">c</span>(<span class="fl">3.5</span>, <span class="dv">2</span>), <span class="dt">axfont=</span><span class="dv">9</span>)</a></code></pre></div>
<iframe src="corp2.html" height="2100" width="525" style="border: none"></iframe>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
